<?phpnamespace App\Models;use CodeIgniter\Model;class TerkirimModel extends Model{    protected $table      = 'pengajuan_sent';    protected $primaryKey = 'sent_id';    protected $useTimestamps = false;    protected $allowedFields = ['no_invoice', 'no_dokumen', 'barcode', 'link_cetak', 'status', 'tgl_sent'];    public function getNoUrut()    {        $this->select('max(no_dokumen) as last_no_dokumen');        $this->like('no_dokumen', date('y'), 'after');        $last = $this->first()['last_no_dokumen'];        $noUrut = (int) substr($last, 3, 5);        $noUrut++;        return $noUrut;    }    public function getGrafik($status, $date)    {        $this->where('status', $status);        $this->like('tgl_sent', $date, 'after');        return count($this->findAll());    }        public function getPEB()    {        $this->select('nama_client,sent_id,pengajuan.pengajuan_id as pengajuan_id,no_dokumen,pengajuan.no_invoice as no_invoice,tgl_sent');        $this->select('(select count(*) from lampiran where jenis_file = "peb" and lampiran.pengajuan_id=pengajuan.pengajuan_id) as peb');        $this->join('pengajuan', 'pengajuan.no_invoice=pengajuan_sent.no_invoice');        $this->join('client', 'client.client_id=pengajuan.client_id');        $this->where([            'pengajuan_sent.status' => 'terbit',            'pengajuan.status_dokumen' => 'diterima',        ]);        return $this->get()->getResult();    }}