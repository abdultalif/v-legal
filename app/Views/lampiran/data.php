<?= $this->extend('layout/template'); ?><?= $this->section('content'); ?><?= form_open('lampiran/multi_delete', ['id'=>'form-bulk']); ?><div class="card">    <div class="card-header">        <?php if(userdata('role') == 'superadmin') : ?>        <button type="button" class="btn btn-danger btn-sm" onclick="bulk_delete()">            <i class="fa fa-trash"></i>            Hapus        </button>        <?php endif; ?>        <div class="card-tools">            <div class="input-group">                <div class="input-group-prepend">                    <div class="input-group-text">                        <button type="button" class="btn btn-tool" id="btn-refresh">                            <i class="fas fa-sync-alt"></i>                        </button>                    </div>                </div>                <select id="jenis_file" class="form-control">                    <option value="">Show All</option>                    <optgroup label="Lampiran Pasca Ekspor">                        <option value="peb">PEB</option>                    </optgroup>                    <optgroup label="Lampiran Permohonan">                        <option value="permohonan">Permohonan</option>                        <option value="invoice">Invoice</option>                        <option value="packing_list">Packing List</option>                        <option value="cites">CITES</option>                        <option value="po">PO</option>                    </optgroup>                </select>            </div>        </div>    </div>    <div class="card-body p-0">        <table id="lampiran-data" class="table table-sm table-striped w-100">            <thead>                <th width="25">                    <input type="checkbox" id="select_all" class="text-center">                </th>                <th width="50">No. </th>                <th>Tanggal</th>                <th>Eksportir</th>                <th>No Invoice</th>                <th class="text-truncate">Jenis</th>                <th width="100" class="text-center"></th>            </thead>            <tbody></tbody>        </table>    </div></div><?= form_close(); ?><?= $this->endSection(); ?><?= $this->section('addons'); ?><script type="text/javascript">$(function() {    if ($("#lampiran-data").length > 0) {        var table = $("#lampiran-data").DataTable({            "processing": true,            "serverSide": true,            "ajax": "<?=base_url('lampiran/json');?>",            buttons: ['copy', 'csv', 'print', 'excel'],            dom: "<'row px-2 px-md-4 pt-2'<'col-md-3'l><'col-md-5 text-center'B><'col-md-4'f>>" +                "<'row'<'col-md-12'tr>>" +                "<'row px-2 px-md-4 py-3'<'col-md-5'i><'col-md-7'p>>",            lengthMenu: [                [20, 50, 100],                [20, 50, 100]            ],            responsive: true,            order: [                [1, 'desc']            ],            type: 'GET',            columns: [{                    data: 'lampiran_id'                },                {                    data: 'lampiran_id'                },                {                    data: 'tgl_lampiran'                },                {                    data: 'nama_client'                },                {                    data: 'no_invoice'                },                {                    data: 'jenis_file'                },                {                    data: 'lampiran_id'                },            ],            columnDefs: [{                targets: [0, -1],                orderable: false,                searchable: false            }, {                "targets": 0,                "render": function(data, type, row, meta) {                    return `<input name="checked[]" class="check" value="${data}" type="checkbox">`;                }            }, {                "targets": 5,                "render": function(data, type, row, meta) {                    return `<span class="text-uppercase">${data}</span>`;                }            }, {                "targets": 6,                "render": function(data, type, row, meta) {                    return `                        <div class="text-center">                            <div class="btn-group">                                <a href="<?=base_url()?>/lampiran/download/${data}" class="btn btn-xs btn-default">                                    <i class="fa fa-download fa-fw"></i> Download                                </a>                            </div>                        </div>                    `;                }            }],            rowId: function(a) {                return a;            },            rowCallback: function(row, data, iDisplayIndex) {                var info = this.fnPagingInfo();                var page = info.iPage;                var length = info.iLength;                var index = page * length + (iDisplayIndex + 1);                $('td:eq(1)', row).html(index);            }        });        table.buttons().container().appendTo('#dataTable_wrapper .col-md-5:eq(0)');        $('#btn-refresh').on('click', function(){            table.ajax.reload();        });    }    $('#select_all').on('click', function() {        if (this.checked) {            $('.check').each(function() {                this.checked = true;                $('#select_all').prop('checked', true);            });        } else {            $('.check').each(function() {                this.checked = false;                $('#select_all').prop('checked', false);            });        }    });    $('#jenis_file').on('change', function() {        let jenis = $(this).val();        let ajaxUrl = "<?=base_url()?>/lampiran/json/" + jenis;        $('#lampiran-data').DataTable().ajax.url(ajaxUrl).load();    });});function bulk_delete() {    if ($('#lampiran-data tbody tr .check:checked').length == 0) {        alert('Tidak ada data yang dipilih');    } else {        if (confirm('Confirm delete?')) {            $('#form-bulk').submit();        }    }}</script><?= $this->endSection(); ?>